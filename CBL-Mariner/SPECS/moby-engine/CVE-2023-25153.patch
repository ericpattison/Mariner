from commit 9e4acc02807a012a51f68afef41f189a350a16cd

diff -ru moby-20.10.14-orig/vendor/github.com/containerd/containerd/images/archive/importer.go moby-20.10.14/vendor/github.com/containerd/containerd/images/archive/importer.go
--- moby-20.10.14-orig/vendor/github.com/containerd/containerd/images/archive/importer.go	2023-03-15 13:29:35.779238288 -0700
+++ moby-20.10.14/vendor/github.com/containerd/containerd/images/archive/importer.go	2023-03-15 14:19:06.216217317 -0700
@@ -24,7 +24,6 @@
 	"encoding/json"
 	"fmt"
 	"io"
-	"io/ioutil"
 	"path"
 
 	"github.com/containerd/containerd/archive/compression"
@@ -222,12 +221,14 @@
 	return writeManifest(ctx, store, idx, ocispec.MediaTypeImageIndex)
 }
 
+const (
+	kib        = 1024
+	mib        = 1024 * kib
+	jsonLimit  = 20 * mib
+)
+
 func onUntarJSON(r io.Reader, j interface{}) error {
-	b, err := ioutil.ReadAll(r)
-	if err != nil {
-		return err
-	}
-	return json.Unmarshal(b, j)
+	return json.NewDecoder(io.LimitReader(r, jsonLimit)).Decode(j)
 }
 
 func onUntarBlob(ctx context.Context, r io.Reader, store content.Ingester, size int64, ref string) (digest.Digest, error) {
