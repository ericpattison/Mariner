From 2152f11235c5cdfe05d188641004d9915287f57b Mon Sep 17 00:00:00 2001
From: Suresh Thelkar <sthelkar@microsoft.com>
Date: Fri, 17 Feb 2023 10:34:40 +0530
Subject: [PATCH] Patch for CVE-2022-46663

---
 line.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/line.c b/line.c
index b8f609e..b611d26 100644
--- a/line.c
+++ b/line.c
@@ -593,8 +593,8 @@ ansi_step(pansi, ch)
 		/* Hyperlink ends with \7 or ESC-backslash. */
 		if (ch == '\7')
 			return ANSI_END;
-		if (pansi->prev_esc && ch == '\\')
-			return ANSI_END;
+		if (pansi->prev_esc)
+			return (ch == '\\') ? ANSI_END : ANSI_ERR;
 		pansi->prev_esc = (ch == ESC);
 		return ANSI_MID;
 	}
-- 
2.38.1

