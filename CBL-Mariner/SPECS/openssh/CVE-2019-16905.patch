--- ./sshkey-xmss-orig.c	2020-10-19 13:08:05.657397679 -0700
+++ ./sshkey-xmss.c	2020-10-19 13:07:42.953419382 -0700
@@ -977,7 +977,8 @@
 		goto out;
 	}
 	/* check that an appropriate amount of auth data is present */
-	if (sshbuf_len(encoded) < encrypted_len + authlen) {
+	if (sshbuf_len(encoded) < authlen ||
+		sshbuf_len(encoded) - authlen < encrypted_len) {
 		r = SSH_ERR_INVALID_FORMAT;
 		goto out;
 	}
